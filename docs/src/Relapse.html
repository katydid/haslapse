<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Relapse</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-2"></a><span>    </span><a href="Relapse.html#parseGrammar"><span class="hs-identifier hs-var">parseGrammar</span></a><span class="hs-special">,</span><span> </span><a href="Relapse.html#memoize"><span class="hs-identifier hs-var">memoize</span></a><span class="hs-special">,</span><span> </span><a href="Relapse.html#Refs"><span class="hs-identifier hs-type">Refs</span></a><span class="hs-special">,</span><span> </span><a href="Relapse.html#Mem"><span class="hs-identifier hs-type">Mem</span></a><span>
</span><a name="line-3"></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-4"></a><span>
</span><a name="line-5"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Except</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">throwError</span><span class="hs-special">)</span><span>
</span><a name="line-6"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">state</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">runState</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">State</span><span class="hs-special">)</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Parser.html"><span class="hs-identifier">Parser</span></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Patterns.html"><span class="hs-identifier">Patterns</span></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="MapDeriv.html"><span class="hs-identifier">MapDeriv</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><a href="Parsers.html"><span class="hs-identifier">Parsers</span></a><span>
</span><a name="line-12"></a><span>
</span><a name="line-13"></a><span class="hs-keyword">type</span><span> </span><a name="Refs"><a href="Relapse.html#Refs"><span class="hs-identifier">Refs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Patterns.html#Refs"><span class="hs-identifier hs-type">Patterns</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Refs</span></a><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-identifier">parseGrammar</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Except</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="Relapse.html#Refs"><span class="hs-identifier hs-type">Refs</span></a><span>
</span><a name="line-16"></a><a name="parseGrammar"><a href="Relapse.html#parseGrammar"><span class="hs-identifier">parseGrammar</span></a></a><span> </span><a name="local-1627460541"><a href="#local-1627460541"><span class="hs-identifier">grammarString</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="Parser.html#parseGrammar"><span class="hs-identifier hs-var">Parser</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">parseGrammar</span></a><span> </span><a href="#local-1627460541"><span class="hs-identifier hs-var">grammarString</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-17"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-1627460542"><a href="#local-1627460542"><span class="hs-identifier">l</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-1627460542"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-18"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-1627460543"><a href="#local-1627460543"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-1627460543"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-19"></a><span>
</span><a name="line-20"></a><span class="hs-keyword">type</span><span> </span><a name="Mem"><a href="Relapse.html#Mem"><span class="hs-identifier">Mem</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Relapse.html#Refs"><span class="hs-identifier hs-type">Refs</span></a><span class="hs-special">,</span><span> </span><a href="Patterns.html#Pattern"><span class="hs-identifier hs-type">Patterns</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Pattern</span></a><span class="hs-special">,</span><span> </span><a href="MapDeriv.html#Mem"><span class="hs-identifier hs-type">MapDeriv</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Mem</span></a><span class="hs-special">)</span><span>
</span><a name="line-21"></a><span>
</span><a name="line-22"></a><span class="hs-identifier">memoize</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Relapse.html#Refs"><span class="hs-identifier hs-type">Refs</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Relapse.html#Mem"><span class="hs-identifier hs-type">Mem</span></a><span>
</span><a name="line-23"></a><a name="memoize"><a href="Relapse.html#memoize"><span class="hs-identifier">memoize</span></a></a><span> </span><a name="local-1627460544"><a href="#local-1627460544"><span class="hs-identifier">refs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-1627460544"><span class="hs-identifier hs-var">refs</span></a><span class="hs-special">,</span><span> </span><a href="Patterns.html#lookupRef"><span class="hs-identifier hs-var">Patterns</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookupRef</span></a><span> </span><a href="#local-1627460544"><span class="hs-identifier hs-var">refs</span></a><span> </span><span class="hs-string">&quot;main&quot;</span><span class="hs-special">,</span><span> </span><a href="MapDeriv.html#newMem"><span class="hs-identifier hs-var">MapDeriv</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">newMem</span></a><span class="hs-special">)</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- nullable :: Patterns.Pattern -&gt; Mem -&gt; State MapDeriv.Mem Bool</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- nullable p (refs, _, mem) = state (MapDeriv.mnullable refs p) mem</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-comment">-- validate :: Tree t =&gt; Mem -&gt; [t] -&gt; Except String Bool</span><span>
</span><a name="line-29"></a><span class="hs-comment">-- validate (refs, start, mem) ts = MapDeriv.mderivs mem refs start ts &gt;&gt;=</span><span>
</span><a name="line-30"></a><span class="hs-comment">--     (\derived -&gt; return $ nullable derived (refs, start, mem))</span><span>
</span><a name="line-31"></a></pre></body></html>